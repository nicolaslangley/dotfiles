# Initialize Zsh completion system and harden permissions
autoload -Uz compinit && compinit
compaudit | xargs chmod go-w  # Remove group/other write perms to prevent injection

# Dotfiles export
DOTFILES_DIR=$HOME/.dotfiles
export DOTFILES_DIR

# Antigen plugin manager config
source $DOTFILES_DIR/zsh/antigen_config.sh

# Detect platform and load platform-specific configs
if [[ "$OSTYPE" == "darwin"* ]]; then
  # macOS
  source $DOTFILES_DIR/zsh/path-macos.sh
  source $DOTFILES_DIR/zsh/environment-macos.sh
elif [[ "$OSTYPE" == "msys" || "$OSTYPE" == "cygwin" ]]; then
  # Windows (Git Bash)
  source $DOTFILES_DIR/zsh/path-windows.sh
  source $DOTFILES_DIR/zsh/environment-windows.sh
fi

# Speed up prompt with large repos
DISABLE_UNTRACKED_FILES_DIRTY="true"
